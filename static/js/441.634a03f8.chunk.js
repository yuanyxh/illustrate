"use strict";(self.webpackChunkillustrate=self.webpackChunkillustrate||[]).push([[441],{358:function(e,t,r){r.d(t,{Z:function(){return u}});var i=r(1413),n=r(4925),s=(r(1233),r(6429)),o={progress:"Progress_progress__hzxrY","progress-bar":"Progress_progress-bar__wJzpG","progress-bar-outer":"Progress_progress-bar-outer__Mr1fo","progress-bar-inner":"Progress_progress-bar-inner__YpPex","progress-bar-inner-striped":"Progress_progress-bar-inner-striped__STAf0","progress-bar-inner-striped-flow":"Progress_progress-bar-inner-striped-flow__SxX22","striped-flow":"Progress_striped-flow__1Lgne","is-success":"Progress_is-success__IABXu","is-warning":"Progress_is-warning__9u7J6","is-exception":"Progress_is-exception__ZOkj1","progress-text":"Progress_progress-text__DngEQ","progress-bar-inner-text":"Progress_progress-bar-inner-text__CrroD"},a=r(7881),c=["status","strokeWidth","percentage","textInside","color","striped","stripedFlow","duration","className","style","format"],l=(0,s.dh)(o);function u(e){var t=e.status,r=e.strokeWidth,u=e.percentage,h=void 0===u?0:u,d=e.textInside,f=void 0!==d&&d,v=e.color,p=e.striped,g=void 0!==p&&p,w=e.stripedFlow,m=void 0!==w&&w,x=e.duration,b=void 0===x?3:x,y=e.className,k=void 0===y?"":y,_=e.style,j=e.format,Z=(0,n.Z)(e,c),S=(Math.abs(h)+100)%100,C=(j||function(e){return e+"%"})(S),I=l(["progress","is-".concat(t)]),E=l({"progress-bar-inner-striped":g,"progress-bar-inner-striped-flow":m});return(0,a.jsxs)("div",(0,i.Z)((0,i.Z)({role:"progressbar","aria-valuenow":S,"aria-valuemin":0,"aria-valuemax":100,className:(0,s.$S)(I,k),style:_},Z),{},{children:[(0,a.jsx)("div",{className:o["progress-bar"],children:(0,a.jsx)("div",{className:o["progress-bar-outer"],style:{height:r},children:(0,a.jsx)("div",{className:(0,s.$S)(o["progress-bar-inner"],E),style:{width:"".concat(S,"%"),animationDuration:"".concat(b,"s"),backgroundColor:v},children:(0,s.fM)(f)&&(0,a.jsx)("div",{className:o["progress-bar-inner-text"],children:(0,a.jsx)("span",{children:C})})})})}),(0,s.fM)(!f)&&(0,a.jsx)("div",{className:o["progress-text"],children:(0,a.jsx)("span",{children:C})})]}))}},8876:function(e,t,r){r.r(t),r.d(t,{default:function(){return Ee}});var i=r(1233),n=r(148),s=r(4165),o=r(5861),a=r(9439),c=r(6429),l=r(1413),u=r(5671),h=r(3144);function d(){return new Worker(r.p+"encoder.worker.c10d37b1f9ba44afbbe1.worker.js")}var f=(0,h.Z)((function e(t){(0,u.Z)(this,e),this.value=void 0,this.next=void 0,this.value=t,this.next=null})),v=function(){function e(){(0,u.Z)(this,e),this.queue=void 0,this._size=0,this.queue=new f}return(0,h.Z)(e,[{key:"enqueue",value:function(e){var t=this.queue;if(this.isEmpty())return this.queue=new f(e),++this._size;for(;null!==(r=t)&&void 0!==r&&r.next;){var r;t=t.next}return t?(t.next=new f(e),++this._size):void 0}},{key:"dequeue",value:function(){if(null===this.queue)return this.queue;var e=this.queue;return this.queue=this.queue.next,--this._size,e}},{key:"clear",value:function(){this.queue=null}},{key:"isEmpty",value:function(){return 0===this.size}},{key:"size",get:function(){return this._size}}]),e}(),p=[71,73,70,56,57,97],g=[33,255],w=[33,1],m=[33,254],x=[33,249],b=[44],y=[59],k=4096,_=function(){function e(){(0,u.Z)(this,e),this.pages=void 0,this.cursor=0,this.pages=[],this.newPage()}return(0,h.Z)(e,[{key:"newPage",value:function(){this.pages[this.pages.length]=new Uint8Array(k),this.cursor=0}},{key:"writeByte",value:function(e){this.pages[this.pages.length-1][this.cursor++]=e,this.cursor===k&&this.newPage()}},{key:"writeBytes",value:function(e){for(var t=0;t<e.length;t++)this.writeByte(e[t])}},{key:"writeShort",value:function(e){var t=[255&e,e>>8&255];this.writeBytes(t)}},{key:"writeGifMagic",value:function(){this.writeBytes(p)}},{key:"writeLogicalScreenDescriptor",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.writeShort(e),this.writeShort(t),this.writeBytes([r,i,n])}},{key:"writeApplicationExtension",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.writeBytes(g),this.writeByte(11),this.writeBytes(Array.from((new TextEncoder).encode("NETSCAPE2.0"))),this.writeByte(3),this.writeByte(1),this.writeShort(e),this.writeByte(0)}},{key:"writeGraphicControlExtension",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:40,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.writeBytes(x),this.writeByte(4),this.writeByte(e),this.writeShort(t),this.writeByte(r),this.writeByte(0)}},{key:"writePlainTextExtension",value:function(){this.writeBytes(w)}},{key:"writeCommentExtension",value:function(){this.writeBytes(m)}},{key:"writeImageDescriptor",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.writeBytes(b),this.writeShort(i),this.writeShort(n),this.writeShort(e),this.writeShort(t),this.writeByte(r)}},{key:"export",value:function(){var e=0,t=this.pages.length,r=this.cursor;e=0===r?t*k:t>0?(t-1)*k+r:0;for(var i=new Uint8Array(e),n=0;n<t;n++){var s=this.pages[n];if(r&&n===t-1){var o=s.slice(0,r);i.set(o,n*k);break}i.set(s,n*k)}return i}},{key:"end",value:function(){return this.writeBytes(y),this.export()}}]),e}(),j=_;function Z(){return new Worker(r.p+"decoder.worker.fe14293945b50ac9f350.worker.js")}var S=function(e){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.every((function(e,i){return e===t[i+r]}))}},C=S(p),I=S(g),E=S(x),N=S(w),M=S(m),T=S(b),R=S(y),F=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;(0,u.Z)(this,e),this.cursor=0,this.pattern=void 0,this.mark="never",this.index=0,this.bus=new Map,this.maxWorkers=void 0,this.workers=[],this.activeWorkers=[],this.isRunning=!1,this.maxWorkers=t}return(0,h.Z)(e,[{key:"getBytes",value:function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Uint8Array,e.next=3,t.arrayBuffer();case 3:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"toText",value:function(e){return(new TextDecoder).decode(e)}},{key:"initWorkers",value:function(){for(var e=0;e<this.maxWorkers;e++)this.workers[this.workers.length]=new Z;return this.workers}},{key:"parseShort",value:function(e){var t=e[this.cursor++];return 256*e[this.cursor++]+t}},{key:"parseSubBlocks",value:function(e){for(var t=[],r=e[this.cursor++];0!==r;)t.push(e.slice(this.cursor,this.cursor+=r)),r=e[this.cursor++];return t}},{key:"parse",value:function(e){for(this.parseHeader(e),this.parseLogicalScreenDescriptor(e);this.cursor<e.length;){switch(!0){case 33===e[this.cursor]:this.parseExtension(e);break;case T(e,this.cursor):this.cursor+=b.length,this.parseImage(e);break;case R(e,this.cursor):this.cursor+=y.length,this.mark="end";break;default:if("end"!==this.mark)throw new Error("unknown byte ".concat(e[this.cursor]," in ").concat(this.cursor));this.cursor++}if("end"===this.mark)break}}},{key:"parseHeader",value:function(e){if(!C(e))throw Error("it must be a gif file and the version is 89a");this.pattern.header=this.toText(e.slice(0,this.cursor+=p.length))}},{key:"parseLogicalScreenDescriptor",value:function(e){var t=this.parseShort(e),r=this.parseShort(e),i=e[this.cursor++],n=!!(128&i),s=(112&i)>>4,o=!!(8&i),a=7&i,c=e[this.cursor++],l=e[this.cursor++];this.pattern.logicalScreenDescriptor={width:t,height:r,statistics:{globalColor:n,colorResolution:s,sort:o,globalColorSize:a},backgroundIndex:c,pixelAspectRatio:l},n&&(this.pattern.globalColorTable=this.parseColorTable(e,a))}},{key:"parseExtension",value:function(e){switch(!0){case I(e,this.cursor):"never"!==this.mark&&console.warn("analysis of the analytical step -by -step, it may be an irregular GIF file. block in ".concat(this.cursor)),this.parseApplicationExtension(e);break;case E(e,this.cursor):"never"!==this.mark&&console.warn("is there a consecutive image control block? is this intentional? block in ".concat(this.cursor)),this.mark="graphic",this.parseGraphicControlExtension(e);break;case N(e,this.cursor):this.parsePlainTextExtension(e);break;case M(e,this.cursor):"never"!==this.mark&&console.warn("analysis of the analytical step -by -step, it may be an irregular GIF file. block in ".concat(this.cursor)),this.parseCommentExtension(e);break;default:throw Error("invalid extension ".concat(e.slice(this.cursor,this.cursor+2).join(", ")," in ").concat(this.cursor))}}},{key:"parseColorTable",value:function(e,t){for(var r=1<<t+1,i=[],n=0;n<r;n++)i.push([e[this.cursor++],e[this.cursor++],e[this.cursor++]]);return i}},{key:"parseApplicationExtension",value:function(e){var t=this.cursor;this.cursor+=g.length;var r=e[this.cursor++],i=this.toText(e.slice(this.cursor,this.cursor+=r));this.cursor++;var n=e[this.cursor++],s=this.parseShort(e);if(this.pattern.applicationExtension={id:n,cursor:t,application:i,loop:s},0!==e[this.cursor++])throw Error("unknown byte, it should be the ending character 0x00, but encountered ".concat(e[this.cursor]));console.log("exec parseApplicationExtension")}},{key:"parseGraphicControlExtension",value:function(e){this.cursor+=x.length,this.cursor++;var t=e[this.cursor++],r=(28&t)>>2,i=!!(2&t),n=!!(1&t),s=10*this.parseShort(e),o=e[this.cursor++];if(this.pattern.graphicControlExtension={disposal:r,userInput:i,transparency:n,delay:s,transparencyIndex:o},0!==e[this.cursor++])throw Error("unknown byte, it should be the ending character 0x00, but encountered ".concat(e[this.cursor]))}},{key:"parsePlainTextExtension",value:function(e){var t=this.cursor;this.cursor+=w.length,this.cursor++;for(var r=this.parseShort(e),i=this.parseShort(e),n=this.parseShort(e),s=this.parseShort(e),o=e[this.cursor++],a=e[this.cursor++],l=e[this.cursor++],u=e[this.cursor++],h=this.parseSubBlocks(e),d="",f=0;f<h.length;f++)for(var v=0;v<h[f].length;v++)d+=String.fromCharCode(h[f][v]);(0,c.xb)(this.pattern.plainTextExtension)&&(this.pattern.plainTextExtension=[]),this.pattern.plainTextExtension.push({index:this.index++,cursor:t,offsetLeft:r,offsetTop:i,gridWidth:n,gridHeight:s,charWidth:o,charHeight:a,textColorIndex:l,textBackgroundIndex:u,text:d,control:"graphic"===this.mark?this.pattern.graphicControlExtension:void 0}),this.mark="never"}},{key:"parseCommentExtension",value:function(e){var t=this.cursor;this.cursor+=m.length;for(var r=this.parseSubBlocks(e),i="",n=0;n<r.length;n++)for(var s=0;s<r[n].length;s++)i+=String.fromCharCode(r[n][s]);(0,c.xb)(this.pattern.commentExtension)&&(this.pattern.commentExtension=[]),this.pattern.commentExtension.push({index:this.index++,cursor:t,comments:i})}},{key:"parseImage",value:function(e){var t,r=this.cursor,i=this.parseShort(e),n=this.parseShort(e),s=this.parseShort(e),o=this.parseShort(e),a=e[this.cursor++],l=!!(128&a),u=!!(64&a),h=!!(32&a),d=7&a;l&&(t=this.parseColorTable(e,d));var f=e[this.cursor++],v=this.parseSubBlocks(e);(0,c.xb)(this.pattern.frames)&&(this.pattern.frames=[]),this.pattern.frames.push({index:this.index++,cursor:r,offsetLeft:i,offsetTop:n,width:s,height:o,statistics:{localColor:l,interlace:u,sort:h,localColorSize:d},localColorTable:t,lzwMiniCodeSize:f,blocks:v,control:"graphic"===this.mark?this.pattern.graphicControlExtension:void 0}),this.mark="never"}},{key:"unzip",value:function(){var e=this,t=this.initWorkers(),r=this.pattern.globalColorTable,i=this.pattern.logicalScreenDescriptor.statistics.globalColor,n=this.pattern.frames.slice(0);this.pattern.frames=[];for(var s=function(s){var o=n.shift();if((0,c.xb)(o))return"break";t[s].postMessage((0,l.Z)((0,l.Z)({},o),{},{globalColorTable:r,globalColor:i})),e.activeWorkers.push(t[s]),t[s].addEventListener("message",(function(o){var a=o.data;e.pattern.frames.push(a);var c=e.activeWorkers.indexOf(t[s]);e.activeWorkers.splice(c,1);var u=n.shift();if(u)t[s].postMessage((0,l.Z)((0,l.Z)({},u),{},{globalColorTable:r,globalColor:i})),e.activeWorkers[e.activeWorkers.length]=t[s];else if(0===e.activeWorkers.length){e.isRunning=!1,e.cursor=0,e.mark="never",e.index=0;for(var h=0;h<e.workers.length;h++)e.workers[h].terminate();e.workers=[],e.complete()}}))},o=0;o<t.length;o++){if("break"===s(o))break}}},{key:"complete",value:function(){this.pattern.frames.sort((function(e,t){return e.index-t.index}));for(var e=this.bus.get("finished")||[],t=0;t<e.length;t++)e[t](this.pattern);this.pattern={}}},{key:"on",value:function(e,t){if(this.bus.has(e)){var r=this.bus.get(e);null===r||void 0===r||r.push(t),this.bus.set(e,r||[])}else this.bus.set(e,[t])}},{key:"decode",value:function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isRunning){e.next=2;break}return e.abrupt("return",!1);case 2:return this.isRunning=!0,e.next=5,this.getBytes(t);case 5:r=e.sent,this.pattern={},this.parse(r),this.unzip();case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),L=F,D=function(){function e(t){(0,u.Z)(this,e),this._width=0,this._height=0,this.config=void 0,this.options={delay:40,cycles:0,disposalMethod:4,userInput:0,transparency:0,transparencyIndex:0},this.bus=new Map,this.frames=new v,this.workers=void 0,this.activeWorkers=void 0,this.response=void 0,this._canvas=window.document.createElement("canvas"),this._context=this._canvas.getContext("2d",{willReadFrequently:!0}),this.firstFrame=!0,this.decoder=void 0,this.on=function(e,t){if(this.bus.has(e)){var r=this.bus.get(e);if(r)return r.push(t),this.bus.set(e,r)}this.bus.set(e,[t])},this.config=t||{},this.workers=[],this.activeWorkers=[],this.response=[],this.decoder=new L(null===t||void 0===t?void 0:t.workers)}return(0,h.Z)(e,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"setDelay",value:function(e){this.options.delay=e}},{key:"setCycles",value:function(e){this.options.cycles=e}},{key:"setDisposalMethod",value:function(e){this.options.disposalMethod=e}},{key:"setUserInput",value:function(e){this.options.userInput=e}},{key:"setTransparency",value:function(e){this.options.transparency=e}},{key:"setTransparencyIndex",value:function(e){if(e<0||e>255)return this;this.options.transparencyIndex=Math.floor(e)}},{key:"getOptions",value:function(){return(0,l.Z)({},this.options)}},{key:"setOptions",value:function(e){this.options=(0,c.f0)({},this.options,e)}},{key:"getConfig",value:function(){return(0,l.Z)({},this.config)}},{key:"setConfig",value:function(e){this.config=(0,c.f0)({},this.config,e)}},{key:"addFrame",value:function(e,t){var r={};this.firstFrame&&(this.firstFrame=!1,e instanceof CanvasRenderingContext2D?(this._width=e.canvas.width,this._height=e.canvas.height):(this._width=this.config.width||e.width,this._height=this.config.height||e.height)),e instanceof ImageData?r.data=e:r.data=this.getImageData(e),r.options=(0,c.f0)({index:this.frames.size},this.options,{width:this.width,height:this.height},t||{}),this.frames.enqueue(r)}},{key:"render",value:function(){var e=this;if(this.frames.isEmpty())throw Error("no frame, please add first");for(var t=this.initWorkers(),r=this.frames.size,i=window.performance.now(),n=function(){var n=t[s],o=e.frames.dequeue();if((0,c.xb)(o)||(0,c.xb)(o.value))return{v:void 0};n.postMessage(o.value),e.activeWorkers.push(n),n.addEventListener("message",(function(t){var s=t.data,o=s.index,a=s.data;e.response[o]=a;var c=e.activeWorkers.indexOf(n);e.activeWorkers.splice(c,1);var l=e.frames.dequeue();null!==l&&void 0!==l&&l.value&&(n.postMessage(l.value),e.activeWorkers.push(n));var u=e.bus.get("progress");if(u)for(var h=window.performance.now()-i,d=e.response.length,f=h/d*(r-d),v={total:r,loaded:e.response.length,activeWorkers:e.activeWorkers.length,duration:+(h/1e3).toFixed(2),surplus:+(f/1e3).toFixed(2),percentage:Math.round(d/r*100)},p=0;p<u.length;p++)u[p](v);if(e.frames.isEmpty()&&0===e.activeWorkers.length)return e.complete()}))},s=0;s<t.length;s++){var o=n();if("object"===typeof o)return o.v}}},{key:"getImageData",value:function(e){var t,r,i;e instanceof HTMLImageElement?(null===(r=t=this._context)||void 0===r||r.clearRect(0,0,this.width,this.height),null===(i=t)||void 0===i||i.drawImage(e,0,0,this.width,this.height)):t=e instanceof HTMLCanvasElement?e.getContext("2d",{willReadFrequently:!0}):e;return t.getImageData(0,0,this.width,this.height)}},{key:"initGif",value:function(){var e=new j;e.writeGifMagic();var t=[];if(this.config.background){var r=window.parseInt(this.config.background.slice(1),16),i=[r>>16&255,r>>8&255,255&r];t.push(i,[0,0,0],[0,0,0],[0,0,0])}for(var n=2;t.length>1<<n;)n++;var s=0!==t.length?128|n-1:0;return e.writeLogicalScreenDescriptor(this.config.width||this.width,this.config.height||this.height,112|s),e.writeBytes(t.flat()),e.writeApplicationExtension(this.options.cycles),e}},{key:"initWorkers",value:function(){for(var e=this.config.workers,t=void 0===e?2:e,r=Math.min(this.frames.size,t),i=0;i<r;i++)this.workers[this.workers.length]=new d;return this.workers}},{key:"complete",value:function(){for(var e=this.response,t=this.initGif(),r=0;r<e.length;r++)t.writeBytes(e[r]);var i=t.end(),n=this.bus.get("finished");if(!(0,c.xb)(n)){for(var s=0;s<n.length;s++)n[s](new Blob([i],{type:"image/gif"}));for(var o=0;o<this.workers.length;o++)this.workers[o].terminate();this.firstFrame=!0,this.workers=[],this.response=[]}}}]),e}(),P=r(7321),B=r(9838),G=r(3131),W=r(358),U=r(1272),z=r(4925),O=r(5034),q=r(7474),A={"input-number":"InputNumber_input-number__UDfrQ","input-number-large":"InputNumber_input-number-large__pVFZz","input-number-small":"InputNumber_input-number-small__Vrd7Q","input-number-increase":"InputNumber_input-number-increase__OhwrF","input-number-decrease":"InputNumber_input-number-decrease__aXyCX","is-disabled":"InputNumber_is-disabled__4ii+r","input-number-wrapper":"InputNumber_input-number-wrapper__GCh8v"},V=r(7881),H=["value","change","id","step","min","max","precision","size","disabled"],Y=(0,c.dh)(A);function X(e){var t=e.value,r=e.change,i=e.id,n=e.step,s=void 0===n?1:n,o=e.min,a=void 0===o?-window.Infinity:o,u=e.max,h=void 0===u?window.Infinity:u,d=e.precision,f=e.size,v=void 0===f?"default":f,p=e.disabled,g=(0,z.Z)(e,H),w=Y(["input-number-".concat(v)]),m=Y({"is-disabled":!!p}),x=Y({"is-disabled":+t===a}),b=Y({"is-disabled":+t===h});return(0,V.jsxs)("div",{className:(0,c.$S)(A["input-number"],w,m),children:[(0,V.jsx)("span",{role:"button","aria-label":"decrease number",className:(0,c.$S)(A["input-number-decrease"],x),onClick:function(){var e=(0,c.hj)(t)?t:window.parseInt(""===t.trim()?"0":t);e<=a||r((0,c.hj)(d)?Number((e-s).toFixed(d)):e-s)},children:(0,V.jsx)("i",{className:"iconfont icon-subtraction"})}),(0,V.jsx)("span",{role:"button","aria-label":"increase number",className:(0,c.$S)(A["input-number-increase"],b),onClick:function(){var e=(0,c.hj)(t)?t:window.parseInt(""===t.trim()?"0":t);e>=h||r((0,c.hj)(d)?Number((e+s).toFixed(d)):e+s)},children:(0,V.jsx)("i",{className:"iconfont icon-add"})}),(0,V.jsx)(q.Z,(0,l.Z)({id:i,value:t.toString(),change:function(e){if(""===e.trim())return r(e);if(/\d+/.test(e)){var t=window.parseInt(e),i=t%s;if(0!==i&&(t=t+s-i),t<a||t>h)return;r((0,c.hj)(d)?Number(t):Number(t.toFixed(d)))}},size:v,disabled:p,className:A["input-number-wrapper"]},g))]})}var J={select:"Select_select__OlUEn","select-large":"Select_select-large__-WEGv","select-small":"Select_select-small__oAlI-","select-input":"Select_select-input__EWRDB","select-icon":"Select_select-icon__R+wRh","select-options":"Select_select-options__oQuJh","select-options-item":"Select_select-options-item__0Rny4",selected:"Select_selected__jbi4n"},Q=(0,c.dh)(J),$={active:"zoom-in-active"},K={active:"zoom-out-active"};function ee(e){var t=e.value,r=e.change,n=e.options,s=e.id,o=e.size,c=void 0===o?"default":o,l=e.placeholder,u=void 0===l?"Select":l,h=(0,i.useRef)(null),d=(0,i.useRef)(null),f=(0,i.useState)(!1),v=(0,a.Z)(f,2),p=v[0],g=v[1];(0,O.Yz)(p,h,$,K);var w=(0,i.useMemo)((function(){return n.find((function(e){return e.value===t}))}),[t]);(0,i.useEffect)((function(){return window.addEventListener("click",x),function(){window.removeEventListener("click",x)}}),[]);var m=Q(["select","select-".concat(c)]),x=function(){g(!1)};return(0,V.jsxs)("div",{className:m,children:[(0,V.jsx)(q.Z,{ref:d,id:s,className:J["select-input"],value:(null===w||void 0===w?void 0:w.label)||"",placeholder:u,change:function(){},onClick:function(e){e.stopPropagation(),function(){var e,t;p?(g(!1),null===(e=d.current)||void 0===e||e.blur()):(g(!0),null===(t=d.current)||void 0===t||t.focus())}()},children:{suffix:function(){return(0,V.jsx)("i",{className:"iconfont icon-arrow-down ".concat(J["select-icon"])})}}}),(0,V.jsx)("div",{ref:h,className:J["select-options"],children:n.map((function(e){var i=e.label,n=e.value;return(0,V.jsx)("div",{className:Q({selected:n===t},J["select-options-item"]),onClick:function(e){e.stopPropagation(),r(n),g(!1)},children:(0,V.jsxs)("span",{children:[" ",i," "]})},i)}))})]})}var te={switch:"Switch_switch__ZGaqU","is-disabled":"Switch_is-disabled__0ra8y","switch-large":"Switch_switch-large__Vu2hW","switch-small":"Switch_switch-small__F+Kbw","switch-input":"Switch_switch-input__a533h","switch-core":"Switch_switch-core__7s+a7","is-checked":"Switch_is-checked__OHQRH","switch-action":"Switch_switch-action__23txu"},re=(0,c.dh)(te);function ie(e){var t=e.value,r=e.change,i=e.activeValue,n=e.inactiveValue,s=e.id,o=e.disabled,a=e.size,l=re(["switch","switch-".concat(void 0===a?"default":a)]),u=re({"is-checked":t===i,"is-disabled":!!o});return(0,V.jsxs)("div",{className:(0,c.$S)(l,u),children:[(0,V.jsx)("input",{id:s,className:te["switch-input"],type:"checkbox",role:"switch"}),(0,V.jsx)("span",{className:te["switch-core"],onClick:function(){o||((0,c.jn)(t)?r((function(e){return!e})):(0,c.G7)(i)||(0,c.G7)(n)||r(t===i?n:i))},children:(0,V.jsx)("div",{className:te["switch-action"]})})]})}function ne(e){var t=e.id,r=e.value,n=e.change,s=(0,i.useRef)(null),o=(0,i.useState)("00 : 00 : 05"),c=(0,a.Z)(o,2),l=c[0],u=c[1];return(0,V.jsx)(q.Z,{ref:s,id:t,value:r,change:n,focus:function(){if(null!==s.current){var e=s.current.value.length;s.current.setSelectionRange(e-2,e)}},blur:function(){var e=r.split(":");if(e.length>3)return n(l);var t=!1,i=e.every((function(e){return/\d{2}/.test(e.trim())})),s=(0,a.Z)(e,3),o=s[0],c=s[1],h=s[2],d=window.parseInt(o),f=window.parseInt(c),v=window.parseInt(h);(d>24||f>60||v>60||24===d&&(f>0||v>0))&&(t=!0),i&&!1===t?u(r):n(l)},onKeyDown:function(e){if(null!==s.current&&!1!==["ArrowLeft","ArrowRight","Tab"].includes(e.key)){var t=s.current.selectionStart||0,r=s.current.selectionEnd||0,i=[[0,2],[5,7],[10,12]],n=i.findIndex((function(e){var i=(0,a.Z)(e,2),n=i[0],s=i[1];return t===n&&s===r}));if(-1!==n){var o=[0,0];e.preventDefault(),o="ArrowLeft"===e.key?0===n?i[i.length-1]:i[n-1]:n===i.length-1?i[0]:i[n+1],s.current.setSelectionRange(o[0],o[1])}}}})}var se="Configuration_gif-transfer-form__9S3qS",oe="Configuration_gif-transfer-form-item__abn64",ae="Configuration_gif-transfer-form-item-background__Jkb2p",ce="Configuration_gif-transfer-form-item-index__XRZeB",le="Configuration_gif-transfer-form-itme-color-table__dSwx9",ue="Configuration_gif-transfer-form-itme-inner-color-table__7jr+Z",he="Configuration_color__FxRRv",de=["showList","perfix","className"],fe=[{label:"\u4e0d\u5904\u7406",value:0},{label:"\u4e0b\u4e00\u5e27\u8986\u76d6\u5f53\u524d\u5e27",value:4},{label:"\u6062\u590d\u5230\u80cc\u666f\u989c\u8272",value:8},{label:"\u6062\u590d\u5230\u6e32\u67d3\u5f53\u524d\u5e27\u4e4b\u524d",value:12}],ve=(0,i.forwardRef)((function(e,t){var r=e.showList,n=e.perfix,s=void 0===n?"":n,o=e.className,a=void 0===o?"":o,u=(0,z.Z)(e,de),h=(0,i.useRef)(null),d=(0,i.useRef)(null),f=(0,O.tT)(!1),v=(0,O.tT)("00 : 00 : 05"),p=(0,O.tT)(0),g=(0,O.tT)(0),w=(0,O.tT)(40),m=(0,O.tT)(4),x=(0,O.tT)(0),b=(0,O.tT)(0),y=(0,O.tT)(0),k=(0,O.tT)(0),_=(0,O.tT)("#000000"),j=(0,O.tT)(3),Z=(0,O.tT)({colorList:[],octree:null});(0,i.useEffect)((function(){return window.addEventListener("click",C),function(){window.removeEventListener("click",C)}}),[]),(0,i.useImperativeHandle)(t,(function(){return{getOptions:I,setColorTable:E}}),[v.value,p.value,g.value,w.value,m.value,k.value,_.value,b.value,y.value,x.value,j.value,Z.value]);var S=(0,i.useMemo)((function(){var e;return null===(e=h.current)||void 0===e||e.setAttribute("data-color",_.value),{"--color":_.value}}),[_.value]);(0,O.Yz)(f.value,d,{active:"zoom-in-active"},{active:"zoom-out-active"});var C=function(){return f.change(!1)};function I(){return{time:+v.value.split(":")[2].trim(),width:p.value,height:g.value,scaling:j.value,delay:w.value,background:_.value,disposalMethod:m.value,cycles:k.value,userInput:x.value,transparency:b.value,transparencyIndex:y.value,colorTable:Z.value}}function E(e){Z.change((0,l.Z)({},e))}var N=function(e){var t=e.r,r=e.g,i=e.b;return"rgb(".concat(t,", ").concat(r,", ").concat(i,")")};return(0,V.jsxs)("div",(0,l.Z)((0,l.Z)({className:(0,c.$S)(se,a)},u),{},{children:[(0,c.fM)(r.includes("time"))&&(0,V.jsxs)("div",{className:oe,children:[(0,V.jsx)("label",{htmlFor:s+"duration",children:"\u89c6\u9891\u622a\u53d6\u65f6\u957f\uff1a"}),(0,V.jsx)(ne,(0,l.Z)({id:s+"duration"},v))]}),(0,c.fM)(r.includes("width"))&&(0,V.jsxs)("div",{className:oe,children:[(0,V.jsx)("label",{htmlFor:s+"width",children:"\u5bbd\u5ea6\uff1a"}),(0,V.jsx)(X,(0,l.Z)({id:s+"width",min:0,max:400},y))]}),(0,c.fM)(r.includes("height"))&&(0,V.jsxs)("div",{className:oe,children:[(0,V.jsx)("label",{htmlFor:s+"height",children:"\u9ad8\u5ea6\uff1a"}),(0,V.jsx)(X,(0,l.Z)({id:s+"height",min:0,max:400},y))]}),(0,c.fM)(r.includes("scaling"))&&(0,V.jsxs)("div",{className:oe,children:[(0,V.jsx)("label",{htmlFor:s+"scaling",children:"\u7f29\u653e\u500d\u6570\uff1a"}),(0,V.jsx)(X,(0,l.Z)({id:s+"scaling",min:1},j))]}),(0,c.fM)(r.includes("delay"))&&(0,V.jsxs)("div",{className:oe,children:[(0,V.jsx)("label",{htmlFor:s+"delay",children:"\u5e27\u95f4\u9694(ms)\uff1a"}),(0,V.jsx)(X,(0,l.Z)({id:s+"delay",min:0,max:655350,step:10},w))]}),(0,c.fM)(r.includes("userInput"))&&(0,V.jsxs)("div",{className:oe,children:[(0,V.jsx)("label",{htmlFor:s+"user-input",children:"\u5141\u8bb8\u7528\u6237\u64cd\u4f5c\uff1a"}),(0,V.jsx)(ie,(0,l.Z)({id:s+"user-input",activeValue:2,inactiveValue:0},x))]}),(0,c.fM)(r.includes("cycles"))&&(0,V.jsxs)("div",{className:oe,children:[(0,V.jsx)("label",{htmlFor:s+"cycles",children:"\u5faa\u73af\u6b21\u6570(0:\u65e0\u9650)\uff1a"}),(0,V.jsx)(X,(0,l.Z)((0,l.Z)({id:s+"cycles"},k),{},{min:0,max:65535}))]}),(0,c.fM)(r.includes("disposalMethod"))&&(0,V.jsxs)("div",{className:oe,children:[(0,V.jsx)("label",{htmlFor:s+"dispoal",children:"\u5e27\u66ff\u6362\u65f6\u5f53\u524d\u5e27\uff1a"}),(0,V.jsx)(ee,(0,l.Z)({id:s+"dispoal",options:fe},m))]}),(0,c.fM)(r.includes("background"))&&(0,V.jsxs)("div",{className:oe,children:[(0,V.jsx)("label",{htmlFor:s+"background",children:"\u5168\u5c40\u80cc\u666f\u8272\uff1a"}),(0,V.jsx)("input",{ref:h,className:ae,style:S,id:s+"background",type:"color","data-color":_.value,value:_.value,onChange:function(e){return _.change(e.target.value)}})]}),(0,c.fM)(r.includes("transparency"))&&(0,V.jsxs)("div",{className:oe,children:[(0,V.jsx)("label",{htmlFor:s+"transparency",children:"\u900f\u660e(\u80cc\u666f\u8272)\uff1a"}),(0,V.jsx)(ie,(0,l.Z)({id:s+"transparency",activeValue:1,inactiveValue:0},b))]}),(0,c.fM)(r.includes("transparencyIndex"))&&(0,V.jsxs)("div",{className:oe,children:[(0,V.jsx)("label",{htmlFor:s+"transparency-index",children:"\u900f\u660e\u989c\u8272\u7d22\u5f15\uff1a"}),(0,V.jsxs)("div",{className:ce,children:[(0,V.jsx)(X,(0,l.Z)((0,l.Z)({id:s+"transparency-index",min:0,max:Z.value.colorList.length-1},y),{},{onFocus:function(){Z.value.colorList.length&&f.change(!0)}})),(0,V.jsx)("div",{ref:d,className:le,children:(0,V.jsx)("div",{className:ue,children:Z.value.colorList.map((function(e,t){return(0,V.jsx)("span",{className:he,style:{backgroundColor:N(e)},title:JSON.stringify(e),onClick:function(e){e.stopPropagation(),function(e){y.change(e),f.change(!1)}(t)}},JSON.stringify(e)+t)}))})})]})]})]}))})),pe={"gif-transfer":"GIFVideo_gif-transfer__O2B-Y","gif-video-container":"GIFVideo_gif-video-container__U8dJc","gif-transfer-render":"GIFVideo_gif-transfer-render__2Hcrw","gif-video-config":"GIFVideo_gif-video-config__Ssgl7","gif-video-upload":"GIFVideo_gif-video-upload__dn+WI","gif-video-disabled":"GIFVideo_gif-video-disabled__GKtk0","icon-upload":"GIFVideo_icon-upload__By7YK","gif-video":"GIFVideo_gif-video__-Ov+J","gif-video-status":"GIFVideo_gif-video-status__UqtX6"},ge=(0,c.dh)(pe);function we(){var e=(0,i.useRef)(null),t=(0,i.useRef)(null),r=(0,i.useRef)(null),n=(0,i.useState)(!1),l=(0,a.Z)(n,2),u=l[0],h=l[1],d=(0,i.useState)(!1),f=(0,a.Z)(d,2),v=f[0],p=f[1],g=(0,i.useState)({loaded:0,total:0,activeWorkers:0,duration:0,surplus:0,percentage:0}),w=(0,a.Z)(g,2),m=w[0],x=w[1],b=(0,i.useState)(""),y=(0,a.Z)(b,2),k=y[0],_=y[1],j=(0,i.useState)(null),Z=(0,a.Z)(j,2),S=Z[0],C=Z[1];(0,i.useEffect)((function(){return window.document.addEventListener("dragover",N),window.document.addEventListener("drop",N),function(){k&&window.URL.revokeObjectURL(k),window.document.removeEventListener("dragover",N),window.document.removeEventListener("drop",N)}}),[]);var I=ge({"gif-video-upload":!k,"gif-video-disabled":u},pe["gif-video-container"]),E=ge(["icon-upload"],"iconfont","icon-upload"),N=function(e){e.stopPropagation(),e.preventDefault()},M=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(){var t,r,i,n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==S){e.next=2;break}return e.abrupt("return");case 2:if("function"!==typeof window.showSaveFilePicker){e.next=16;break}return e.next=5,window.showSaveFilePicker({excludeAcceptAllOption:!0,suggestedName:"illustrate.gif",types:[{description:"\u56fe\u50cf\u6587\u4ef6 gif",accept:{"image/gif":[".gif"]}}]});case 5:return t=e.sent,e.next=8,t.createWritable();case 8:return r=e.sent,i=r.getWriter(),e.next=12,i.write(S);case 12:return e.next=14,i.close();case 14:e.next=24;break;case 16:n=window.document.createElement("a"),o=window.URL.createObjectURL(S),n.href=o,n.download="illustrate.gif",window.document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(o);case 24:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(P.Z,{shadow:"never",children:[(0,V.jsxs)("div",{className:pe["gif-transfer"],children:[(0,V.jsxs)("div",{className:pe["gif-transfer-render"],children:[(0,V.jsx)("div",{className:I,onDragOver:function(e){e.stopPropagation(),e.preventDefault()},onDrop:function(e){if(!u){var t=e.dataTransfer.files;if(null!==t&&0!==t.length){var r=t[0];k&&window.URL.revokeObjectURL(k),_(window.URL.createObjectURL(r))}}},onClick:function(){var t;return u||(null===(t=e.current)||void 0===t?void 0:t.click())},children:k?(0,V.jsx)("video",{ref:t,className:pe["gif-video"],src:k,muted:!0,loop:!0,autoPlay:!0,onError:function(){G.Z.alert({type:"error",title:"\u64ad\u653e\u5f02\u5e38",message:"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c \u8bf7\u68c0\u67e5\u89c6\u9891\u683c\u5f0f"}),window.URL.revokeObjectURL(k)}}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("i",{className:E}),(0,V.jsx)("p",{style:{marginTop:5},children:(0,V.jsx)(U.Z,{type:"info",children:"\u70b9\u51fb\u6216\u62d6\u62fd\u4e0a\u4f20\u89c6\u9891\u6587\u4ef6"})})]})}),(0,c.fM)(v)&&(0,V.jsx)(U.Z,{block:!0,type:"primary",style:{marginBottom:15},children:"\u6b63\u5728\u6536\u96c6\u89c6\u9891\u5e27\uff0c\u7a0d\u540e\u5f00\u59cb\u7f16\u8bd1\u3002\u3002\u3002"}),(0,V.jsxs)("div",{className:pe["gif-video-status"],children:[(0,V.jsxs)(U.Z,{block:!0,style:{marginTop:5},children:["\u603b\u5e27\u6570\uff1a",m.total]}),(0,V.jsxs)(U.Z,{block:!0,style:{marginTop:5},children:["\u5df2\u5b8c\u6210\uff1a",m.loaded]}),(0,V.jsxs)(U.Z,{block:!0,style:{marginTop:5},children:["\u6d3b\u52a8\u7ebf\u7a0b\uff1a ",m.activeWorkers]}),(0,V.jsxs)(U.Z,{block:!0,style:{marginTop:5},children:["\u5df2\u7f16\u8bd1\uff1a",m.duration,"\u79d2"]}),(0,V.jsxs)(U.Z,{block:!0,style:{marginTop:5},children:["\u9884\u8ba1\u5269\u4f59\uff1a ",m.surplus,"\u79d2"]}),(0,V.jsx)(W.Z,{style:{marginTop:20},percentage:m.percentage})]})]}),(0,V.jsx)(ve,{ref:r,className:pe["gif-video-config"],showList:["time","delay","cycles","disposalMethod","scaling","userInput"]})]}),(0,V.jsxs)("div",{style:{marginTop:10},children:[(0,V.jsx)(B.Z,{type:"primary",loading:u,onClick:function(){if(null!==t.current){if(t.current.readyState!==HTMLMediaElement.HAVE_ENOUGH_DATA)return G.Z.alert({type:"warning",title:"\u89c6\u9891\u6570\u636e\u4e0d\u6ee1\u8db3\u6761\u4ef6",message:"\u8bf7\u786e\u8ba4\u5f53\u524d\u89c6\u9891\u6570\u636e\u662f\u5426\u5df2\u52a0\u8f7d"});t.current.load(),h(!0),p(!0),C(null),(0,c.Qb)((function(){var e;if(null===t.current||0===t.current.videoWidth)return!1;var i=(null===(e=r.current)||void 0===e?void 0:e.getOptions())||{},n=i.time,s=void 0===n?5:n,o=i.scaling,a=void 0===o?3:o,l=i.cycles,u=void 0===l?0:l,d=i.delay,f=void 0===d?40:d,v=i.disposalMethod,g=void 0===v?4:v,w=i.userInput,m=void 0===w?0:w,b=t.current.videoWidth,y=t.current.videoHeight,k=(0,c.yU)({width:Math.round(b/a),height:Math.round(y/a),willReadFrequently:!0}),_=k.canvas,j=k.context,Z=new D({width:_.width,height:_.height,workers:2});Z.setCycles(u),Z.setDelay(f),Z.setDisposalMethod(g),Z.setUserInput(m),Z.on("progress",(function(e){x(e)})),Z.on("finished",(function(e){h(!1),C(e)}));var S=window.setInterval((function(){if(null!==t.current){if(t.current.currentTime>s)return p(!1),Z.render(),window.clearInterval(S);null===j||void 0===j||j.clearRect(0,0,_.width,_.height),null===j||void 0===j||j.drawImage(t.current,0,0,b,y,0,0,_.width,_.height),Z.addFrame(_)}}),1e3/24);return!0}))}},children:"\u5f00\u59cb\u8f6c\u7801"}),(0,V.jsx)(B.Z,{type:"success",style:{marginLeft:15},disabled:null===S,onClick:M,children:"\u4e0b\u8f7d GIF"}),(0,V.jsx)("p",{style:{marginTop:10},children:(0,V.jsx)(U.Z,{type:"info",children:"\u524d\u7aef\u8f6c\u6362\u8f83\u6162\uff0c\u9650\u5236 gif \u65f6\u957f\u4e3a 60 \u79d2\uff1b\u8272\u76d8\u5728\u7f16\u7801\u65f6\u786e\u8ba4\uff0c\u65e0\u6cd5\u63d0\u524d\u9009\u62e9\u900f\u660e\u8272\uff08PS\uff1a\u663e\u793a\u80cc\u666f\u8272\uff09\u3002"})})]})]}),(0,V.jsx)("input",{ref:e,hidden:!0,type:"file",accept:"video/*",onChange:function(e){var t=e.target.files;if(null!=t&&0!==t.length){k&&window.URL.revokeObjectURL(k);var r=window.URL.createObjectURL(t[0]);_(r)}}})]})}var me=r(3433),xe=(0,h.Z)((function e(){(0,u.Z)(this,e),this.children=[],this.color=void 0,this.pixelCount=0,this.color=null})),be=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if((0,u.Z)(this,e),this.maxDepth=8,this.count=1,this.root=void 0,t>8)throw new Error("the maximum depth cannot exceed 8");this.maxDepth=t,this.root=new xe}return(0,h.Z)(e,[{key:"insertColor",value:function(e){var t=this.root;t.pixelCount++;for(var r=this.maxDepth-1;r>=0;r--){var i=this.getColorIndex(e,r);t.children[i]||(t.children[i]=new xe),(t=t.children[i]).pixelCount++}if(null===t.color)return this.count++,t.color=e;for(var n=["r","g","b"],s=0;s<n.length;s++)t.color[n[s]]+=e[n[s]]}},{key:"getColorIndex",value:function(e,t){var r=0,i=1<<t;return e.r&i&&(r|=1),e.g&i&&(r|=2),e.b&i&&(r|=4),r}},{key:"shrink",value:function(e){if(this.count<=e)return[];for(var t=this.maxDepth-1;t>=0&&(this.reduceColor(this.root,t,0,e),!(this.count<=e));t--);return this.collectColor()}},{key:"reduceColor",value:function(e,t,r,i){if(!(this.count<=i)){var n=(0,me.Z)(e.children);if(t===r)this._reduceColor(e,i);else if(t>r)for(var s=0;s<n.length;s++)null!==n[s]&&void 0!==n[s]&&this.reduceColor(n[s],t,r+1,i)}}},{key:"_reduceColor",value:function(e,t){var r=!0,i=(0,me.Z)(e.children);i.sort((function(e,t){return e.pixelCount-t.pixelCount}));for(var n=0;n<i.length;n++)if(null!==i[n]&&void 0!==i[n]){var s=i[n].color;if(null!==s)if(null!==e.color){for(var o=["r","g","b"],a=0;a<o.length;a++)e.color[o[a]]+=s[o[a]];if(this.count--,this.count<=t){r=!1;for(var c=0;c<n;c++){var l=e.children.indexOf(i[c]);e.children.splice(l,1,null)}break}}else e.color=s}r&&(e.children=[])}},{key:"quantizeColor",value:function(e){for(var t=this.root,r=this.maxDepth-1;r>=0;r--){var i=this.getColorIndex(e,r);if(!t.children[i])break;t=t.children[i]}return t.color}},{key:"collectColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root;if(null===e||void 0===e)return[];for(var t=[],r=e.children,i=0;i<r.length;i++)if(null!==r[i]&&void 0!==r[i]){var n=r[i].color;if(n){if(!n.normalize){var s=n.r,o=n.g,a=n.b;n.r=Math.round(s/r[i].pixelCount)||0,n.g=Math.round(o/r[i].pixelCount)||0,n.b=Math.round(a/r[i].pixelCount)||0,n.normalize=!0}t.push(n)}t.push.apply(t,(0,me.Z)(this.collectColor(r[i])))}return t}},{key:"calcColorDistance",value:function(e,t){var r=Math.sqrt(Math.pow(e.r-t.r,2)+Math.pow(e.g-t.g,2)+Math.pow(e.b-t.b,2));return Math.floor(100*(1-r/Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2))))}}]),e}(),ye=be;var ke=function(e){for(var t=new ye,r=0;r<e.length;r+=4)t.insertColor({r:e[r],g:e[r+1],b:e[r+2]});return t.shrink(256),{colorList:t.collectColor(),octree:t}},_e={"gif-picture":"GIFPicture_gif-picture__6owkV","drawing-board-container":"GIFPicture_drawing-board-container__h-xus","drawing-board":"GIFPicture_drawing-board__4yydy","gif-picture-config":"GIFPicture_gif-picture-config__J6m2w",opterator:"GIFPicture_opterator__gxc9v"},je=["width","height","time","scaling","background"];function Ze(){var e=(0,i.useRef)(null),t=(0,i.useRef)(null),r=(0,i.useRef)(null),n=(0,i.useState)(null),s=(0,a.Z)(n,2),o=s[0],u=s[1],h=(0,i.useRef)(new D),d=(0,i.useState)(!1),f=(0,a.Z)(d,2),v=f[0],p=f[1],g=(0,i.useState)(!1),w=(0,a.Z)(g,2),m=w[0],x=w[1],b=(0,i.useState)(!1),y=(0,a.Z)(b,2),k=y[0],_=y[1],j=(0,i.useState)({left:0,top:0,width:0,height:0}),Z=(0,a.Z)(j,2),S=Z[0],C=Z[1],I=(0,i.useState)([]),E=(0,a.Z)(I,2),N=E[0],M=E[1],T=(0,i.useState)(null),R=(0,a.Z)(T,2),F=R[0],L=R[1];(0,i.useMemo)((function(){h.current.on("finished",(function(e){window.open(window.URL.createObjectURL(e)),p(!1),M([]),U(),null===o||void 0===o||o.beginPath()}))}),[]),(0,i.useEffect)((function(){var t,r=null===(t=e.current)||void 0===t?void 0:t.getContext("2d",{willReadFrequently:!0});u(r),x(!0)}),[]),(0,i.useEffect)((function(){var t;return null===(t=e.current)||void 0===t||t.addEventListener("wheel",W),function(){var t;null===(t=e.current)||void 0===t||t.removeEventListener("wheel",W)}}),[]),(0,i.useEffect)((function(){m&&(O(),x(!1))}),[m]),(0,i.useEffect)((function(){if(!(0,c.xb)(F)){var e=(0,c.yU)({width:F.width,height:F.height}),t=e.canvas,i=e.context;null===i||void 0===i||i.drawImage(F,0,0);var n=null===i||void 0===i?void 0:i.getImageData(0,0,t.width,t.height);if(n){var s,o=ke(n.data);null===(s=r.current)||void 0===s||s.setColorTable(o)}}}),[F]);var W=function(e){return e.preventDefault()},U=function(){var t;(0,c.xb)(e.current)||(0,c.xb)(o)||(o.clearRect(0,0,e.current.width,e.current.height),L(null),_(!1),C({left:0,top:0,width:0,height:0}),x(!0),null===(t=r.current)||void 0===t||t.setColorTable({colorList:[],octree:null}))},O=function(){var t,r;if(!(0,c.xb)(o)){for(var i=(null===(t=e.current)||void 0===t?void 0:t.width)||0,n=(null===(r=e.current)||void 0===r?void 0:r.height)||0,s=o.createImageData(i,n),a=s.data,l=0;l<n;l++)for(var u=0;u<i;u++){var h=l*i+u<<2,d=(l>>2)+(u>>2)&1?204:255;a[h]=d,a[h+1]=d,a[h+2]=d,a[h+3]=255}o.putImageData(s,0,0)}},q=function(e,t,r,i){(0,c.xb)(o)||(o.beginPath(),o.lineWidth=0,o.moveTo(e,t),o.lineTo(e+r,t),o.lineTo(e+r,t+i),o.lineTo(e,t+i),o.strokeStyle="transparent",o.stroke(),o.closePath())},A=function(){if(!((0,c.xb)(e.current)||(0,c.xb)(o)||(0,c.xb)(F)||(0,c.xb)(r.current))){var t=(0,c.yU)({width:S.width,height:S.height}).context;t.drawImage(F,0,0,S.width,S.height);var i=t.getImageData(0,0,S.width,S.height),n=r.current.getOptions(),s=(n.width,n.height,n.time,n.scaling,n.background,(0,z.Z)(n,je));return M((function(e){return[].concat((0,me.Z)(e),[{data:i,options:(0,l.Z)({index:e.length},s)}])})),U(),{data:i,options:(0,l.Z)({index:N.length},s)}}};return(0,V.jsxs)(P.Z,{style:{marginTop:40,overflow:"revert"},shadow:"never",bodyClassName:_e["gif-picture"],children:[(0,V.jsx)("div",{className:_e["drawing-board-container"],children:(0,V.jsx)("canvas",{ref:e,width:400,height:400,className:_e["drawing-board"],onMouseDown:function(e){var t=e.nativeEvent.offsetX,r=e.nativeEvent.offsetY;null!==o&&void 0!==o&&o.isPointInPath(t,r)&&_(!0)},onMouseUp:function(){_(!1)},onMouseMove:function(t){if(!((0,c.xb)(e.current)||(0,c.xb)(o)||(0,c.xb)(F))){var r=t.nativeEvent.offsetX,i=t.nativeEvent.offsetY;if(o.isPointInPath(r,i)?e.current.style.cursor="move":e.current.style.cursor="revert",k){var n=S.left,s=S.top,a=S.width,l=S.height,u=Math.min(e.current.width-a,Math.max(0,n+t.movementX)),h=Math.min(e.current.height-l,Math.max(0,s+t.movementY));o.clearRect(0,0,e.current.width,e.current.height),O(),o.drawImage(F,0,0,F.width,F.height,u,h,a,l),q(u,h,a,l),C({left:u,top:h,width:a,height:l})}}},onMouseLeave:function(){return _(!1)},onWheel:function(t){if(!((0,c.xb)(e.current)||(0,c.xb)(o)||(0,c.xb)(F))){var r=t.nativeEvent.offsetX,i=t.nativeEvent.offsetY;if(o.isPointInPath(r,i)){var n=S.left,s=S.top,a=S.width,l=S.height,u=Math.round(a*(t.deltaY<0?1.2:.8)),h=Math.round(l*(t.deltaY<0?1.2:.8));if(n+u>e.current.width||s+h>e.current.height)return;o.clearRect(0,0,e.current.width,e.current.height),O(),o.drawImage(F,0,0,F.width,F.height,n,s,u,h),q(n,s,u,h),C({left:n,top:s,width:u,height:h})}}}})}),(0,V.jsxs)("div",{className:_e.form,children:[(0,V.jsx)(ve,{ref:r,className:_e["gif-picture-config"],showList:["cycles","delay","disposalMethod","background","transparency","transparencyIndex","userInput"],perfix:"gif-picture"}),(0,V.jsxs)("div",{className:_e.opterator,children:[(0,V.jsx)(B.Z,{type:"default",disabled:v,onClick:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.click()},children:"\u4e0a\u4f20\u56fe\u7247"}),(0,V.jsx)(B.Z,{type:"success",disabled:v||null===F,onClick:A,children:"\u4e0b\u4e00\u5e27"}),(0,V.jsx)(B.Z,{type:"primary",onClick:function(){var e,t,i=A();if(!(0,c.xb)(i)){p(!0);for(var n=[].concat((0,me.Z)(N),[i]),s=Number.MIN_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,a=0;a<n.length;a++){var u=n[a].data;s=Math.max(s,u.width),o=Math.max(o,u.height)}for(var d=0;d<n.length;d++){var f=n[d],v=f.data,g=v.width,w=v.height,m=f.options;m.offsetLeft=Math.floor((s-g)/2),m.offsetTop=Math.floor((o-w)/2),h.current.addFrame(n[d].data,(0,l.Z)({width:g,height:w},m))}h.current.setCycles((null===(e=r.current)||void 0===e?void 0:e.getOptions().cycles)||0),h.current.setConfig({width:s,height:o,background:null===(t=r.current)||void 0===t?void 0:t.getOptions().background}),h.current.render()}},disabled:0===N.length&&null===F,loading:v,children:"\u7f16\u7801 GIF"})]}),(0,V.jsx)("input",{ref:t,hidden:!0,type:"file",accept:"image/*",onChange:function(t){var r=t.target.files;if(!(0,c.xb)(r)&&0!==r.length){U();var i=window.URL.createObjectURL(r[0]),n=new Image;n.src=i,n.onload=function(){if(Math.max(n.width,n.height)>400)(0,G.Z)({type:"warning",title:"\u56fe\u7247\u9650\u5236",message:"\u8bf7\u4e0d\u8981\u4e0a\u4f20\u5927\u4e8e 400 x 400 \u7684\u56fe\u50cf"});else{var t,r,s=(((null===(t=e.current)||void 0===t?void 0:t.width)||0)-n.width)/2,a=(((null===(r=e.current)||void 0===r?void 0:r.height)||0)-n.height)/2;null===o||void 0===o||o.drawImage(n,s,a,n.width,n.height),q(s,a,n.width,n.height),L(n),C({left:s,top:a,width:n.width,height:n.height})}window.URL.revokeObjectURL(i)},n.onerror=function(){G.Z.alert({type:"error",title:"\u52a0\u8f7d\u5931\u8d25",message:"\u56fe\u50cf\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u786e\u8ba4\u56fe\u7247\u683c\u5f0f"})},t.target.value=""}}})]})]})}var Se={title:"GIFPlayer_title__0v2Qm","gif-player-container":"GIFPlayer_gif-player-container__bhuHi",operator:"GIFPlayer_operator__hLJOQ"};function Ce(){var e=(0,i.useRef)(null),t=(0,i.useRef)(new D),r=(0,i.useRef)(null),n=(0,i.useState)(null),l=(0,a.Z)(n,2),u=l[0],h=l[1],d=(0,i.useState)(null),f=(0,a.Z)(d,2),v=f[0],p=f[1],g=(0,i.useState)(null),w=(0,a.Z)(g,2),m=w[0],x=w[1],b=(0,i.useState)(null),y=(0,a.Z)(b,2),k=y[0],_=y[1],j=(0,i.useState)(null),Z=(0,a.Z)(j,2),S=Z[0],C=Z[1],I=(0,i.useState)(0),E=(0,a.Z)(I,2),N=E[0],M=E[1],T=(0,i.useState)(0),R=(0,a.Z)(T,2),F=R[0],L=R[1],W=(0,i.useState)(0),z=(0,a.Z)(W,2),O=z[0],q=z[1],A=(0,i.useState)(-1),H=(0,a.Z)(A,2),Y=H[0],X=H[1],J=(0,i.useState)(!0),Q=(0,a.Z)(J,2),$=Q[0],K=Q[1];function ee(e,t,r,i){if(!(0,c.xb)(u)&&!(0,c.xb)(v)){var n=u.logicalScreenDescriptor.backgroundIndex;if(u.logicalScreenDescriptor.statistics.globalColor){var s,o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[255,255,255],t=(0,a.Z)(e,3),r=t[0],i=t[1],n=t[2];return"#".concat(r.toString(16)).concat(i.toString(16)).concat(n.toString(16))}(null===u||void 0===u||null===(s=u.globalColorTable)||void 0===s?void 0:s[n]);v.fillStyle=o,v.fillRect(e,t,r,i)}}}(0,i.useMemo)((function(){t.current.decoder.on("finished",(function(e){h(e)}))}),[]),(0,i.useEffect)((function(){if(!(0,c.xb)(e.current)){var t=e.current.getContext("2d",{willReadFrequently:!0});p(t)}}),[]),(0,i.useEffect)((function(){(0,c.xb)(m)||t.current.decoder.decode(m)}),[m]),(0,i.useEffect)((function(){if(!((0,c.xb)(u)||(0,c.xb)(e.current)||(0,c.xb)(v))){e.current.width=u.logicalScreenDescriptor.width,e.current.height=u.logicalScreenDescriptor.height,ee(0,0,e.current.width,e.current.height);var t=u.applicationExtension,r=u.frames,i=(t||{}).loop,n=void 0===i?0:i;_(r),M(n)}}),[u]),(0,i.useEffect)((function(){var t,r;if(!((0,c.xb)(k)||(0,c.xb)(v)||(0,c.xb)(e.current))){var i=k[O];if(!(0,c.xb)(null===i||void 0===i?void 0:i.data)){var n=k[0===O?k.length-1:O-1],s=n.control;switch((null===s||void 0===s?void 0:s.disposal)||0){case 2:v.clearRect(n.offsetLeft,n.offsetTop,n.width,n.height),ee(n.offsetLeft,n.offsetTop,n.width,n.height);break;case 3:S?v.putImageData(S,n.offsetLeft,n.offsetTop):ee(n.offsetLeft,n.offsetTop,n.width,n.height)}if(2===((null===(t=i.control)||void 0===t?void 0:t.disposal)||0)){var o=v.getImageData(i.offsetLeft,i.offsetTop,i.width,i.height);C(o)}if(v.putImageData(i.data,i.offsetLeft,i.offsetTop),!1!==$){var a=window.setTimeout((function(){O===k.length-1?0===N||F<N-1?(q(0),L((function(e){return++e}))):(K(!1),window.clearTimeout(a)):q((function(e){return++e}))}),(null===(r=i.control)||void 0===r?void 0:r.delay)||10);return X(a),function(){return window.clearTimeout(a)}}}}}),[O,k]),(0,i.useEffect)((function(){(0,c.xb)(k)||($?(q((function(e){return e===k.length-1?0:++e})),L(0)):window.clearTimeout(Y))}),[$]);var te=function(e){(0,c.xb)(k)||(K(!1),"prev"===e?q((function(e){return 0===e?k.length-1:--e})):"next"===e&&q((function(e){return e===k.length-1?0:++e})))},re=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(){var t,r,i,n,a,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,c.xb)(k)){e.next=2;break}return e.abrupt("return");case 2:if(t=(0,c.yU)({willReadFrequently:!0}),r=t.canvas,i=t.context,"function"!==typeof window.showDirectoryPicker){e.next=16;break}return e.next=6,window.showDirectoryPicker({mode:"readwrite"});case 6:n=e.sent,a=(0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.width=k[t].width,r.height=k[t].height,i.putImageData(k[t].data,0,0),r.toBlob(function(){var e=(0,o.Z)((0,s.Z)().mark((function e(r){var i,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getFileHandle(t.toString().padStart(k.length.toString().length,"0")+".jpg",{create:!0});case 2:return i=e.sent,e.next=5,i.createWritable();case 5:o=e.sent,(a=o.getWriter()).write(r),a.close();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),"image/jpeg");case 4:case"end":return e.stop()}}),e)})),l=0;case 9:if(!(l<k.length)){e.next=14;break}return e.delegateYield(a(l),"t0",11);case 11:l++,e.next=9;break;case 14:e.next=17;break;case 16:G.Z.alert({type:"warning",title:"\u4e0b\u8f7d\u5931\u8d25",message:"\u5f53\u524d\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 window.showDirectoryPicker \u65b9\u6cd5\uff0c\u5efa\u8bae\u4f7f\u7528\u6700\u65b0\u6d4f\u89c8\u5668\uff0c\u6216\u524d\u5f80 MDN \u67e5\u770b\u6d4f\u89c8\u5668\u517c\u5bb9\u6027"});case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,V.jsxs)(P.Z,{style:{marginTop:40},shadow:"never",children:[(0,V.jsx)("h1",{className:Se.title,children:"GIF Player"}),(0,V.jsxs)("div",{className:Se["gif-player-container"],onClick:function(){var e;return null===(e=r.current)||void 0===e?void 0:e.click()},children:[(0,V.jsx)("canvas",{ref:e,width:0,height:0}),(0,c.fM)(k)&&(0,V.jsxs)("div",{className:Se.operator,onClick:function(e){return e.stopPropagation()},children:[(0,V.jsx)(B.Z,{type:"default",onClick:function(){return K((function(e){return!e}))},children:$?"\u6682\u505c":"\u64ad\u653e"}),(0,V.jsx)(B.Z,{type:"default",onClick:function(){return te("prev")},children:"\u4e0a\u4e00\u5e27"}),(0,V.jsx)(B.Z,{type:"default",onClick:function(){return te("next")},children:"\u4e0b\u4e00\u5e27"}),(0,V.jsx)(B.Z,{type:"success",onClick:re,children:"\u4e0b\u8f7d\u5168\u90e8"}),(0,V.jsx)(U.Z,{type:"info",children:"".concat(O.toString().padStart(((null===k||void 0===k?void 0:k.length)||1).toString().length,"0"),"/").concat(((null===k||void 0===k?void 0:k.length)||1)-1)})]})]}),(0,V.jsx)("input",{ref:r,hidden:!0,type:"file",accept:"image/gif",onChange:function(t){var r=t.target.files;(0,c.xb)(r)||0===r.length||(r[0].type.includes("image/gif")?(window.clearTimeout(Y),e.current&&v&&(v.clearRect(0,0,e.current.width,e.current.height),e.current.width=0,e.current.height=0),x(r[0]),h(null),_(null),C(null),M(0),L(0),X(-1),K(!0)):G.Z.alert({type:"error",title:"\u56fe\u7247\u683c\u5f0f\u9519\u8bef",message:"\u8bf7\u4e0a\u4f20 GIF \u56fe\u7247\u6587\u4ef6"}),t.target.value="")}})]})}var Ie={"gif-explorer":"GIF-Explorer_gif-explorer__jxXfZ"};function Ee(){return(0,V.jsxs)("div",{className:Ie["gif-explorer"],children:[(0,V.jsx)(n.Z,{platform:{blog:{title:"\u6df1\u5165\u6d45\u51fa GIF",url:"https://yuanyxh.com/posts/produce/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%20GIF.html"},juejin:{url:"https://juejin.cn/post/7277831097391775755"},zhihu:{url:"https://zhuanlan.zhihu.com/p/655933856"},csdn:{url:"https://blog.csdn.net/yuanfgbb/article/details/132845424?spm=1001.2014.3001.5502"}}}),(0,V.jsx)(we,{}),(0,V.jsx)(Ze,{}),(0,V.jsx)(Ce,{})]})}}}]);
//# sourceMappingURL=441.634a03f8.chunk.js.map